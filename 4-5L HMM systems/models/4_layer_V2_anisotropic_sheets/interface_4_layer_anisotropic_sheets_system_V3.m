%spectrum_anisotropic_sheets(R,d,hs,alofi,md,dd)
%constants
Rad=0.0000010;
dep=1;
hs=1;
alofi=0;
%plot data
[RS0,RP0,wavelength0,epsper0,epspll0]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0,1);

[RS05,RP05,wavelength05,epsper05,epspll05]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.05,0.95);

[RS10,RP10,wavelength10,epsper10,epspll10]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.10,0.90);

[RS15,RP15,wavelength15,epsper15,epspll15]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.15,0.85);

[RS20,RP20,wavelength20,epsper20,epspll20]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.20,0.80);

[RS25,RP25,wavelength25,epsper25,epspll25]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.25,0.75);

[RS30,RP30,wavelength30,epsper30,epspll30]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.30,0.70);
% [RS31,RP31,wavelength31,epsper31,epspll31]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.31,0.69);
% [RS32,RP32,wavelength32,epsper32,epspll32]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.32,0.68);
% [RS33,RP33,wavelength33,epsper33,epspll33]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.33,0.67);
% [RS34,RP34,wavelength34,epsper34,epspll34]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.34,0.66);
[RS35,RP35,wavelength35,epsper35,epspll35]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.35,0.65);
% [RS36,RP36,wavelength36,epsper36,epspll36]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.36,0.64);
% [RS37,RP37,wavelength37,epsper37,epspll37]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.37,0.63);
% [RS38,RP38,wavelength38,epsper38,epspll38]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.38,0.62);
% [RS39,RP39,wavelength39,epsper39,epspll39]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.39,0.61);
[RS40,RP40,wavelength40,epsper40,epspll40]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.40,0.60);
% [RS41,RP41,wavelength41,epsper41,epspll41]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.41,0.59);
% [RS42,RP42,wavelength42,epsper42,epspll42]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.42,0.58);
% [RS43,RP43,wavelength43,epsper43,epspll43]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.43,0.57);
% [RS44,RP44,wavelength44,epsper44,epspll44]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.44,0.56);
[RS45,RP45,wavelength45,epsper45,epspll45]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.45,0.55);
% [RS46,RP46,wavelength46,epsper46,epspll46]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.46,0.54);
% [RS47,RP47,wavelength47,epsper47,epspll47]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.47,0.53);
% [RS48,RP48,wavelength48,epsper48,epspll48]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.48,0.52);
% [RS49,RP49,wavelength49,epsper49,epspll49]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.49,0.51);
[RS50,RP50,wavelength50,epsper50,epspll50]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.50,0.50);
% [RS51,RP51,wavelength51,epsper51,epspll51]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.51,0.49);
% [RS52,RP52,wavelength52,epsper52,epspll52]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.52,0.48);
% [RS53,RP53,wavelength53,epsper53,epspll53]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.53,0.47);
% [RS54,RP54,wavelength54,epsper54,epspll54]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.54,0.46);
[RS55,RP55,wavelength55,epsper55,epspll55]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.55,0.45);
% [RS56,RP56,wavelength56,epsper56,epspll56]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.56,0.44);
% [RS57,RP57,wavelength57,epsper57,epspll57]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.57,0.43);
% [RS58,RP58,wavelength58,epsper58,epspll58]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.58,0.42);
% [RS59,RP59,wavelength59,epsper59,epspll59]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.59,0.41);
[RS60,RP60,wavelength60,epsper60,epspll60]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.60,0.40);
% [RS61,RP61,wavelength61,epsper61,epspll61]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.61,0.39);
% [RS62,RP62,wavelength62,epsper62,epspll62]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.62,0.38);
% [RS63,RP63,wavelength63,epsper63,epspll63]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.63,0.37);
% [RS64,RP64,wavelength64,epsper64,epspll64]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.64,0.36);
[RS65,RP65,wavelength65,epsper65,epspll65]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.65,0.35);
% [RS66,RP66,wavelength66,epsper66,epspll66]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.66,0.34);
% [RS67,RP67,wavelength67,epsper67,epspll67]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.67,0.33);
% [RS68,RP68,wavelength68,epsper68,epspll68]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.68,0.32);
% [RS69,RP69,wavelength69,epsper69,epspll69]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.69,0.31);
[RS70,RP70,wavelength70,epsper70,epspll70]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.70,0.30);

[RS75,RP75,wavelength75,epsper75,epspll75]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.75,0.25);

[RS80,RP80,wavelength80,epsper80,epspll80]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.80,0.20);

[RS85,RP85,wavelength85,epsper85,epspll85]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.85,0.15);

[RS90,RP90,wavelength90,epsper90,epspll90]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.90,0.10);

[RS95,RP95,wavelength95,epsper95,epspll95]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,0.95,0.05);

[RS100,RP100,wavelength100,epsper100,epspll100]=spectrum_anisotropic_sheets(Rad,dep,hs,alofi,1,0);
%with out the image factor (eta=0)
% [RS55_V2,RP55_V2,wavelength55_V2,epsper55_V2,epspll55_V2]=spectrum_anisotropic_sheets_V2(Rad,dep,hs,alofi,0.55,0.45);

figure;
tiledlayout(1,1);
p1=nexttile;
hold on
plot(p1,wavelength0,RS0*100,'c');
plot(p1,wavelength05,RS05*100);
plot(p1,wavelength10,RS10*100);
plot(p1,wavelength15,RS15*100,'m');
plot(p1,wavelength20,RS20*100);
plot(p1,wavelength25,RS25*100);
plot(p1,wavelength30,RS30*100);
%plot(p1,wavelength31,RS31*100);
%plot(p1,wavelength32,RS32*100);
% plot(p1,wavelength33,RS33*100);
% plot(p1,wavelength34,RS34*100)
plot(p1,wavelength35,RS35*100,'g');
% plot(p1,wavelength36,RS36*100);
% plot(p1,wavelength37,RS37*100);
% plot(p1,wavelength38,RS38*100);
% plot(p1,wavelength39,RS39*100);
plot(p1,wavelength40,RS40*100);
% plot(p1,wavelength41,RS41*100);
% plot(p1,wavelength42,RS42*100);
% plot(p1,wavelength43,RS43*100);
% plot(p1,wavelength44,RS44*100);
plot(p1,wavelength45,RS45*100);
% plot(p1,wavelength46,RS46*100);
% plot(p1,wavelength47,RS47*100);
% plot(p1,wavelength48,RS48*100);
% plot(p1,wavelength49,RS49*100);
plot(p1,wavelength50,RS50*100,'r');
% plot(p1,wavelength51,RS51*100);
% plot(p1,wavelength52,RS52*100);
% plot(p1,wavelength53,RS53*100);
% plot(p1,wavelength54,RS54*100);
plot(p1,wavelength55,RS55*100);
% plot(p1,wavelength56,RS56*100);
% plot(p1,wavelength57,RS57*100);
% plot(p1,wavelength58,RS58*100);
% plot(p1,wavelength59,RS59*100);
plot(p1,wavelength60,RS60*100);
% plot(p1,wavelength61,RS61*100);
% plot(p1,wavelength62,RS62*100);
% plot(p1,wavelength63,RS63*100);
% plot(p1,wavelength64,RS64*100);
plot(p1,wavelength65,RS65*100,'b');
% plot(p1,wavelength66,RS66*100);
% plot(p1,wavelength67,RS67*100);
% plot(p1,wavelength68,RS68*100);
% plot(p1,wavelength69,RS69*100);
plot(p1,wavelength70,RS70*100);
plot(p1,wavelength75,RS75*100);
% plot(p1,wavelength80,RS80*100','MarkerFaceColor','#77AC30');
plot(p1,wavelength80,RS80*100','y');
plot(p1,wavelength85,RS85*100);
plot(p1,wavelength90,RS90*100);
plot(p1,wavelength95,RS95*100);
plot(p1,wavelength100,RS100*100,'k');
hold off
xlabel(p1,'wavelength')
ylabel(p1,'%')
%legend(p1,'RS35','RS50','RS60','RS62','RS63','RS65','RS70','RS75','RS0','RS100')
%legend(p1,'RS55','RS56','RS57','RS58','RS59','RS60','RS61','RS62','RS63','RS64','RS65','RS66','RS67','RS68','RS69','RS70')
%legend(p1,'RS50','RS55','RS58','RS61','RS64','RS67','RS70','RS75')
legend(p1,'RS0','RS05','RS10','RS15','RS20','RS25','RS30','RS35','RS40','RS45','RS50','RS55','RS60','RS65','RS70','RS75','RS80','RS85','RS90','RS95','RS100','Location','northwest','NumColumns',2)
%legend(p1,'RS0','RS10','RS20','RS30','RS40','RS50','RS60','RS70','RS80','RS90','RS100','Location','northwest','NumColumns',2)
% legend(p1,'RS0','RS15','RS35','RS50','RS65','RS80','RS100','Location','northwest','NumColumns',2)
axis(p1,[300 900 -1 101])



% % p1=nexttile;
% % hold on
% % plot(p1,wavelength55,real(epsper55));
% % plot(p1,wavelength55,real(epspll55));
% % hold off
% % e3+sqrt(eps4pll*eps4per)
% % p2=nexttile;
% % hold on
% % plot(p2,wavelength55,imag(epspll55));
% % plot(p2,wavelength55,imag(epsper55));
% % plot(p2,wavelength60,imag(epspll60));
% % plot(p2,wavelength60,imag(epsper60));
% % plot(p2,wavelength65,imag(epspll65));
% % plot(p2,wavelength65,imag(epsper65));
% % plot(p2,wavelength70,imag(epspll70));
% % plot(p2,wavelength70,imag(epsper70));
% % plot(p2,wavelength35,real(epsper35));
% % plot(p2,wavelength35,real(epspll35));
% % plot(p2,wavelength45,real(epsper45));
% % plot(p2,wavelength45,real(epspll45));
% % plot(p2,wavelength50,real(epspll50));
% % plot(p2,wavelength50,real(epsper50));
% % plot(p2,wavelength55,real(epspll55));
% % plot(p2,wavelength55,real(epsper55));
% % plot(p2,wavelength60,real(epspll60));
% % plot(p2,wavelength60,real(epsper60));
% % plot(p2,wavelength65,real(epspll65));
% % plot(p2,wavelength65,real(epsper65));
% % plot(p2,wavelength70,real(epspll70));
% % plot(p2,wavelength70,real(epsper70));
% % 
% % plot(p2,wavelength75,real(epspll75));
% % plot(p2,wavelength75,real(epsper75));
% % hold off
% % xlabel(p2,'wavelength')
% % ylabel(p2,'Real($\varepsilon$)','Interpreter','latex')
% % legend(p2,'eps pll55','eps per55','eps pll60','eps per60','eps pll65','eps per65','eps pll70','eps per70')
% % legend(p2,'RS35per','RS35pll','RS45per','RS45pll','RS50per','RS50pll','RS55per','RS55pll')
% % axis(p2,[300 900 0 0.1])
% % 
% % min(imag(epsper70)) max(imag(epsper70))
% % 
% % p2=nexttile;
% % %plot(p2,wavelength,RP35*100,'r');
% % hold on
% % % plot(p2,wavelength,RP50*100);
% % plot(p2,wavelength,RP55*100);
% % plot(p2,wavelength,RS56*100);
% % plot(p2,wavelength,RP57*100);
% % plot(p2,wavelength,RS58*100);
% % plot(p2,wavelength,RP59*100);
% % plot(p2,wavelength,RP60*100);
% % plot(p2,wavelength,RS61*100);
% % plot(p2,wavelength,RP62*100);
% % plot(p2,wavelength,RP63*100);
% % plot(p2,wavelength,RS64*100);
% % plot(p2,wavelength,RP65*100,'b');
% % plot(p2,wavelength,RS66*100);
% % plot(p2,wavelength,RP67*100);
% % plot(p2,wavelength,RP68*100);
% % plot(p2,wavelength,RS69*100);
% % plot(p2,wavelength,RP70*100);
% % % plot(p2,wavelength,RP75*100);
% % % plot(p2,wavelength,RP0*100,'c');
% % % plot(p2,wavelength,RP100*100,'g');
% % 
% % hold off
% % xlabel(p2,'wavelength')
% % ylabel(p2,'%')
% % % legend(p2,'RP35','RP50','RP60','RP62','RP63','RP65','RP70','RP75','RP0','RP100')
% % legend(p2,'RP55','RP56','RP57','RP58','RP59','RP60','RP61','RP62','RP63','RP64','RP65','RP66','RP67','RP68','RP69','RP70')
% % axis(p2,[300 900 -1 101])
% % 
% % p3=nexttile;
% % hold on
% % plot(p2,wavelength55,imag(epspll55));
% % plot(p2,wavelength55,imag(epsper55));
% % plot(p2,wavelength60,imag(epspll60));
% % plot(p2,wavelength60,imag(epsper60));
% % plot(p2,wavelength65,imag(epspll65));
% % plot(p2,wavelength65,imag(epsper65));
% % plot(p2,wavelength70,imag(epspll70));
% % plot(p3,wavelength70,imag(epsper70));
% % plot(p3,wavelength45,real(epspll45));
% % plot(p3,wavelength50,real(epspll50));
% % plot(p3,wavelength50,real(epsper50));
% % plot(p3,wavelength55,real(epspll55));
% % plot(p3,wavelength55,real(epsper55));
% % plot(p3,wavelength60,real(epspll60));
% % plot(p3,wavelength60,real(epsper60));
% % plot(p3,wavelength65,real(epspll65));
% % plot(p3,wavelength65,real(epsper65));
% % plot(p3,wavelength70,real(epspll70));
% % plot(p3,wavelength70,real(epsper70));
% % 
% % plot(p3,wavelength75,real(epspll75));
% % plot(p3,wavelength75,real(epsper75));
% % hold off
% % xlabel(p3,'wavelength')
% % ylabel(p3,'Real($\varepsilon$)','Interpreter','latex')
% % legend(p2,'eps pll55','eps per55','eps pll60','eps per60','eps pll65','eps per65','eps pll70','eps per70')
% % legend(p3,'RS45','RS50','RS55','RS60','RS65','RS70')
% % axis(p3,[300 900 0 0.1])
% % 
% % 
% % p2=nexttile;
% % hold on
% % plot(p2,wavelength0,imag(epspll0),'c','DisplayName','R0,  imag(epspll)');
% % plot(p2,wavelength0,imag(epsper0),'c--','DisplayName','R0,  imag(epsper)');
% % 
% % plot(p2,wavelength15,imag(epspll15),'m','DisplayName','R15,  imag(epspll)');
% % plot(p2,wavelength15,imag(epsper15),'m--','DisplayName','R15,  imag(epsper)');
% % 
% % plot(p2,wavelength35,imag(epspll35),'g','DisplayName','R35,  imag(epspll)');
% % plot(p2,wavelength35,imag(epsper35),'g--','DisplayName','R35,  imag(epsper)');
% % 
% % plot(p2,wavelength50,imag(epspll50),'r','DisplayName','R50,  imag(epspll)');
% % plot(p2,wavelength50,imag(epsper50),'r--','DisplayName','R50,  imag(epsper)');
% % 
% % plot(p2,wavelength65,imag(epspll65),'b','DisplayName','R65,  imag(epspll)');
% % plot(p2,wavelength65,imag(epsper65),'b--','DisplayName','R65,  imag(epsper)');
% % 
% % plot(p2,wavelength80,imag(epspll80),'MarkerFaceColor','#77AC30','DisplayName','R80,  imag(epspll)');
% % plot(p2,wavelength80,imag(epsper80),'--','MarkerFaceColor','#77AC30','DisplayName','R80,  imag(epsper)');
% % 
% % plot(p2,wavelength100,imag(epspll100),'k','DisplayName','R100,  imag(epspll)');
% % plot(p2,wavelength100,imag(epsper100),'k--','DisplayName','R100,  imag(epsper)');
% % hold off
% % 
% % xlabel(p2,'wavelength')
% % ylabel(p2,'imag($\varepsilon$)','Interpreter','latex')
% % legend(p2,'Location','northwest','NumColumns',2,'AutoUpdate', 'off')
% % yline(p2,0);
% % axis(p2,[300 900 -inf inf])
% % 
% % 
% p3=nexttile;
% hold on
% plot(p3,wavelength0,real(epspll0),'c','DisplayName','R0,  real(epspll)');
% plot(p3,wavelength0,real(epsper0),'c--','DisplayName','R0,  real(epsper)');
% 
% plot(p3,wavelength15,real(epspll15),'m','DisplayName','R15,  real(epspll)');
% plot(p3,wavelength15,real(epsper15),'m--','DisplayName','R15,  real(epsper)');
% 
% plot(p3,wavelength35,real(epspll35),'g','DisplayName','R35,  real(epspll)');
% plot(p3,wavelength35,real(epsper35),'g--','DisplayName','R35,  real(epsper)');
% 
% plot(p3,wavelength50,real(epspll50),'r','DisplayName','R50,  real(epspll)');
% plot(p3,wavelength50,real(epsper50),'r--','DisplayName','R50,  real(epsper)');
% 
% plot(p3,wavelength65,real(epspll65),'b','DisplayName','R65,  real(epspll)');
% plot(p3,wavelength65,real(epsper65),'b--','DisplayName','R65,  real(epsper)');
% 
% % % plot(p3,wavelength80,real(epspll80),'MarkerFaceColor','#77AC30','DisplayName','R80,  real(epspll)');
% % plot(p3,wavelength80,real(epsper80),'MarkerFaceColor','#77AC30','DisplayName','R80,  real(epsper)');
% 
% plot(p3,wavelength80,real(epspll80),'y','DisplayName','R80,  real(epspll)');
% plot(p3,wavelength80,real(epsper80),'--y','DisplayName','R80,  real(epsper)');
% 
% 
% plot(p3,wavelength100,real(epspll100),'k','DisplayName','R100,  real(epspll)');
% plot(p3,wavelength100,real(epsper100),'k--','DisplayName','R100,  real(epsper)');
% 
% hold off
% xlabel(p3,'wavelength')
% ylabel(p3,'Real($\varepsilon$)','Interpreter','latex')
% legend(p3,'Location','northwest','NumColumns',2,'AutoUpdate', 'off')
% yline(p3,0);
% axis(p3,[300 900 -inf inf])
% 
% clear variables